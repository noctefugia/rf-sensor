#ifndef __ADXL345_H
#define __ADXL345_H

#include "utils.h" 
#include "i2c_soft.h" 

#define ADXL345_I2C_PAIR I2CSP_MAIN
#define ADXL345_I2C_ADDRESS ((uint8_t)0b00111010)
#define ADXL345_I2C_WRITE_FLAG ((uint8_t)0x00)
#define ADXL345_I2C_READ_FLAG ((uint8_t)0x01)

#define ADXL345_COMPONENT_SZ ((uint8_t)2)
#define ADXL345_COMPONENT_COUNT ((uint8_t)3)
#define ADXL345_RAW_BYTE_COUNT ((uint8_t)ADXL345_COMPONENT_COUNT*ADXL345_COMPONENT_SZ)

typedef enum {
	ADXLR_DEVID = 0x00,
	ADXLR_THRESH_TAP = 0x1D,
	ADXLR_OFSX,
	ADXLR_OFSY,
	ADXLR_OFSZ,
	ADXLR_DUR,
	ADXLR_LATENT,
	ADXLR_WINDOW,
	ADXLR_THRESH_ACT,
	ADXLR_THRESH_INACT,
	ADXLR_TIME_INACT,
	ADXLR_ACT_INACT_CTL,
	ADXLR_THRESH_FF,
	ADXLR_TIME_FF,
	ADXLR_TAP_AXES,
	ADXLR_ACT_TAP_STATUS,
	ADXLR_BW_RATE,
	ADXLR_POWER_CTL,
	ADXLR_INT_ENABLE,
	ADXLR_INT_MAP,
	ADXLR_INT_SOURCE,
	ADXLR_DATA_FORMAT,
	ADXLR_DATAX0,
	ADXLR_DATAX1,
	ADXLR_DATAY0,
	ADXLR_DATAY1,
	ADXLR_DATAZ0,
	ADXLR_DATAZ1,
	ADXLR_FIFO_CTL,
	ADXLR_FIFO_STATUS,
	ADXLR_INVALID
} ADXL345_REG_TypeDef;

//power ctl bits
static enum {
	ADXLRBPC_WAKEUP_8HZ =	0b00000000,
	ADXLRBPC_WAKEUP_4HZ =	0b00000001,
	ADXLRBPC_WAKEUP_2HZ =	0b00000010,
	ADXLRBPC_WAKEUP_1HZ =	0b00000011,
	ADXLRBPC_SLEEP =			0b00000100,
	ADXLRBPC_MEASURE =		0b00001000,
	ADXLRBPC_AUTO_SLEEP =	0b00010000,
	ADXLRBPC_LINK =				0b00100000
};

//data format bits
static enum {
	ADXLRBDF_RANGE_2G =		0b00000000,
	ADXLRBDF_RANGE_4G =		0b00000001,
	ADXLRBDF_RANGE_8G =		0b00000010,
	ADXLRBDF_RANGE_16G =	0b00000011,
	ADXLRBDF_JUSTIFY =		0b00000100,
	ADXLRBDF_FULL_RES =		0b00001000,
	ADXLRBDF_INT_INVERT =	0b00100000,
	ADXLRBDF_SPI =				0b01000000,
	ADXLRBDF_SELF_TEST =	0b10000000
};

//bw rate bits
static enum {
	ADXLRBBWR_LOW_RATE_0_10HZ =		0b00000000,
	ADXLRBBWR_LOW_RATE_0_20HZ =		0b00000001,
	ADXLRBBWR_LOW_RATE_0_39HZ =		0b00000010,
	ADXLRBBWR_LOW_RATE_0_78HZ =		0b00000011,
	ADXLRBBWR_LOW_RATE_1_56HZ =		0b00000100,
	ADXLRBBWR_LOW_RATE_3_13HZ =		0b00000101,
	ADXLRBBWR_LOW_RATE_6_25HZ =		0b00000110,
	ADXLRBBWR_LOW_RATE_12_5HZ =		0b00000111,
	ADXLRBBWR_LOW_RATE_25HZ =			0b00001000,
	ADXLRBBWR_LOW_RATE_50HZ =			0b00001001,
	ADXLRBBWR_LOW_RATE_100HZ =		0b00001010,
	ADXLRBBWR_LOW_RATE_200HZ =		0b00001011,
	ADXLRBBWR_LOW_RATE_400HZ =		0b00001100,
	ADXLRBBWR_LOW_RATE_800HZ =		0b00001101,
	ADXLRBBWR_LOW_RATE_1600HZ =		0b00001110,
	ADXLRBBWR_LOW_RATE_3200HZ =		0b00001111,
	ADXLRBBWR_LOW_POWER =					0b00010000
};


I2CS_STATE_TypeDef ADXL345_Init(void);
I2CS_STATE_TypeDef ADXL345_SoftReset(void);
I2CS_STATE_TypeDef ADXL345_ReadData(int16_t *buff);
I2CS_STATE_TypeDef ADXL345_ReadDataRaw(uint8_t *buff);

#endif /* __ADXL345_H */